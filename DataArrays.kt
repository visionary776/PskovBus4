package es.esy.pskovbus.pskovbus





import android.util.Log



class DataArrays {


    internal var routePath = arrayOf(
        intArrayOf(), // 0
        intArrayOf(
            10006,
            150064,
            62,
            140018,
            20008,
            30014,
            61,
            60059,
            58,
            55,
            56,
            130049,
            53,
            120051,
            50050,
            42,
            32,
            41,
            50001,
            120039,
            52,
            130040,
            54,
            57,
            60022,
            60,
            30016,
            20009,
            140019,
            63,
            150065,
            10006
        ), // 1 route
        intArrayOf(
            10006,
            160104,
            110027,
            106,
            108,
            23,
            110,
            70020,
            100067,
            73,
            71,
            80127,
            131,
            128,
            129,
            80031,
            44,
            72,
            90011,
            100035,
            68,
            70021,
            25,
            113,
            24,
            109,
            107,
            110028,
            160105,
            114,
            10006
        ), //2
        intArrayOf(
            36,
            116,
            140018,
            20008,
            30015,
            66,
            70020,
            100067,
            73,
            71,
            80127,
            80031,
            44,
            72,
            90011,
            100035,
            68,
            70021,
            25,
            103,
            30017,
            20009,
            140115,
            117,
            36
        ), //3
        intArrayOf(
            125,
            990013,
            150064,
            62,
            140018,
            20008,
            30015,
            66,
            70020,
            100067,
            73,
            71,
            80127,
            80031,
            44,
            72,
            90011,
            100035,
            68,
            70021,
            25,
            103,
            30017,
            20009,
            140019,
            63,
            150065,
            990048
        ), //4
        intArrayOf(
            10006,
            160104,
            110027,
            106,
            108,
            23,
            30017,
            20009,
            140115,
            117,
            40002,
            94,
            10,
            92,
            89,
            87,
            30015,
            113,
            24,
            109,
            107,
            110028,
            160105,
            114,
            10006
        ), //5
        intArrayOf(
            34,
            10006,
            160104,
            110027,
            79,
            81,
            101,
            100083,
            73,
            71,
            80127,
            80031,
            44,
            72,
            90011,
            100084,
            102,
            82,
            80,
            110028,
            160105,
            114,
            10007,
            34
        ), //6
        intArrayOf(
            100035,
            68,
            70021,
            25,
            103,
            30014,
            61,
            60059,
            58,
            5,
            57,
            60022,
            60,
            30015,
            66,
            70020,
            100067,
            69,
            33,
            113,
            129,
            130,
            100035
        ), //7
        intArrayOf(30015, 113, 24, 107, 109, 12, 110028, 123, 140018, 20008, 30015), //8
        intArrayOf(10006, 150065, 990048, 4, 990013, 10006), //9
        intArrayOf(),
        intArrayOf(
            10006,
            160104,
            123,
            140018,
            20008,
            30014,
            88,
            90,
            91,
            93,
            40002,
            94,
            10,
            92,
            89,
            87,
            30016,
            20009,
            140019,
            124,
            160105,
            114,
            10006
        ), //11
        intArrayOf(10006, 150065, 990048, 29, 125, 990013, 10006), //12
        intArrayOf(),
        intArrayOf(
            37,
            118,
            10006,
            150064,
            62,
            140018,
            20008,
            30015,
            78,
            76,
            74,
            73,
            71,
            80127,
            80031,
            44,
            72,
            47,
            75,
            77,
            103,
            30017,
            20009,
            140019,
            63,
            150065,
            119,
            37
        ), //14
        intArrayOf(
            10006,
            150064,
            62,
            140018,
            20008,
            30015,
            66,
            70020,
            100067,
            69,
            33,
            113,
            120,
            129,
            130,
            100035,
            68,
            70021,
            25,
            103,
            30017,
            20009,
            140019,
            63,
            150065,
            10006
        ), //15(116)
        intArrayOf(
            10006,
            160104,
            110027,
            79,
            81,
            101,
            100083,
            90045,
            86,
            120051,
            50050,
            42,
            32,
            41,
            50001,
            120039,
            85,
            90011,
            100084,
            102,
            82,
            80,
            110028,
            160105,
            114,
            10006
        ), //16
        intArrayOf(
            10006,
            150064,
            62,
            140018,
            20008,
            30015,
            66,
            70020,
            100067,
            69,
            33,
            112,
            3,
            70,
            80031,
            44,
            72,
            90011,
            100035,
            68,
            70021,
            25,
            103,
            30017,
            20009,
            140019,
            63,
            150065,
            10006
        ), //17
        intArrayOf(
            26,
            50001,
            120039,
            52,
            130040,
            54,
            57,
            60022,
            60,
            30015,
            66,
            70020,
            100067,
            73,
            71,
            80031,
            44,
            72,
            90011,
            100035,
            68,
            70021,
            25,
            103,
            30014,
            61,
            60059,
            58,
            55,
            56,
            130049,
            53,
            120051,
            50050,
            26
        ), //118
        intArrayOf(30015, 113, 24, 107, 109, 79, 81, 38, 82, 80, 110028, 123, 140018, 20008, 30015), //19
        intArrayOf(), ///112
        intArrayOf(),
        intArrayOf(
            40002,
            94,
            10,
            92,
            89,
            87,
            30015,
            66,
            70020,
            100067,
            69,
            33,
            80031,
            44,
            72,
            90045,
            86,
            52,
            130040,
            43,
            130049,
            53,
            85,
            90011,
            100035,
            68,
            70021,
            25,
            103,
            30014,
            88,
            90,
            91,
            93,
            40002
        ), //22
        intArrayOf(10006, 119, 40002, 94, 10, 93, 118, 10006), //23
        intArrayOf(),
        intArrayOf(
            40002,
            94,
            10,
            99,
            97,
            95,
            60022,
            60,
            30015,
            66,
            70020,
            100067,
            73,
            71,
            80127,
            112,
            30,
            126,
            80031,
            44,
            72,
            90011,
            100035,
            68,
            70021,
            25,
            103,
            30014,
            61,
            60059,
            96,
            98,
            100,
            93,
            40002
        ), //25
        intArrayOf(),
        intArrayOf(),
        intArrayOf(),
        intArrayOf(),
        intArrayOf(
            40002,
            94,
            10,
            92,
            89,
            87,
            30015,
            66,
            70020,
            100067,
            69,
            33,
            80031,
            44,
            72,
            90011,
            100035,
            68,
            70021,
            25,
            103,
            30014,
            88,
            90,
            91,
            93,
            40002
        )  //30
    )







    fun getTransitWay(stopStart: Stop?, stopFinal: Stop?): Array<Array<String>?> {

        var routeResulting: Int
        var straightRouteList = ""
      //  var transitResult = arrayOf <Array<String>>()
        var ar1:Array<String> = Array(1){""}
        var ar2:Array<String> = Array(100){""}
        var ar3:Array<String> = Array(100){""}
        var transitResult:Array<Array<String>?> = arrayOf(ar1, ar2, ar3)
       // transitResult[0] = arrayOfNulls(1)
        val routeListStartPoint = stopStart!!.routeHere// список маршрутов начальной остановки

        var counter = 0
        for (i in routeListStartPoint) {

            for (k in 1 until routePath[i].size) {// проходим по траектории маршрута
                if (routePath[i][k] == stopFinal!!.id) {
                    if (counter > 0) {
                        straightRouteList += ", "
                    }


                    routeResulting = check18(i)

                    straightRouteList += Integer.toString(routeResulting)

                    counter++

                }
            }
        }

        var straightRes:String
        if (straightRouteList.isNotEmpty()) {

            straightRes = straightRouteList
        } else {
            straightRes = "не найдено."
        }
        ar1[0]= "Прямые маршруты: $straightRes"


        val transitionWay = checktransitionPath(stopStart, stopFinal)

        if (transitionWay.size != 0) {
           // val size = transitionWay.size / 5
            Log.d("MyLogs", "transitionWay  : $transitionWay")

            var k = 1
            ar2[0]= "Варианты пересадок: \n"
            var j = 0
            while (j < transitionWay.size) {


                ar2[k]=" "
                ar3[k - 1]= transitionWay[j + 4]
               Log.d("MyLogs", "transitionWay[j + 4]  : ${transitionWay[j + 4]}")
               Log.d("MyLogs", "пересадки  : $ar3")

                ar2[k]= transitionWay[j] + transitionWay[j + 1] +
                        transitionWay[j + 2] + transitionWay[j + 3]



                /*Log.d(TAG, "++++transitResult[1][k] : "+transitResult[1][k]);*/

                k++
                j += 5
            }
        }



        return transitResult
    }



    private fun checktransitionPath(stopStart: Stop?, stopFinal: Stop?): ArrayList<String> {
        var routeResulting: Int

        val routeListStartPoint = stopStart!!.routeHere//Список маршрутов начальной остановки
        val routeListFinalPoint = stopFinal!!.routeHere// Маршруты конечной остановки

        val transitResultList = ArrayList<String>()
        val stopdata = StopData()

        val stopId = stopStart.id
        val stopFinalId = stopFinal.id


        for (routehere in routeListStartPoint) {

            var begin = false
            for (stop in routePath[routehere]) {
                if (stop == stopId) {
                    begin = true
                    continue
                }
                if (stop == stopFinalId) {
                    break
                }
                if (begin && stop > 10000) {

                    val hub = stop / 10000
                    for (finalroute in routeListFinalPoint) {
                        var begin1 = false
                        for (i in routePath[finalroute].size - 1 downTo 0) {
                            val stopInFinalRoute = routePath[finalroute][i]//Здесь плолучаем id

                            if (stopInFinalRoute == stopFinalId) {
                                begin1 = true
                            }


                            if (stopInFinalRoute > 10000 && (stopInFinalRoute / 10000 == hub) and begin1) {


                                routeResulting = check18(routehere)

                                transitResultList.add(Integer.toString(routeResulting))

                                val namefirst = stopdata.getStopNameById(stop)

                                transitResultList.add(" > $namefirst")

                                if (stop != stopInFinalRoute) {
                                    val nameSecond = stopdata.getStopNameById(stopInFinalRoute)
                                    transitResultList.add(" > $nameSecond > ")
                                } else {
                                    transitResultList.add(" >")
                                }
                                routeResulting = check18(finalroute)

                                transitResultList.add(Integer.toString(routeResulting))
                                transitResultList.add(Integer.toString(stop))

                                break

                            }
                        }

                    }

                }

            }
        }
        var k = 0
        var size = transitResultList.size


        var i = 5
        while (i < size) {


            if (transitResultList[k].equals(transitResultList[i]) && transitResultList[k + 1].equals(transitResultList[i + 1]) and transitResultList[k + 2].equals(
                    transitResultList[i + 2]
                )
            ) {
                val temp = transitResultList[k + 3] + ", " + transitResultList[i + 3]

                transitResultList[k + 3] = temp

                transitResultList.removeAt(i)
                transitResultList.removeAt(i)
                transitResultList.removeAt(i)
                transitResultList.removeAt(i)
                transitResultList.removeAt(i)
                i -= 5
                size -= 5
            } else if (transitResultList[i].equals(transitResultList[i + 3])) {

                transitResultList.removeAt(i)
                transitResultList.removeAt(i)
                transitResultList.removeAt(i)
                transitResultList.removeAt(i)
                transitResultList.removeAt(i)
                i -= 5
                size -= 5
            } else if (transitResultList[k].equals(transitResultList[i]) && transitResultList[k + 3].equals(
                    transitResultList[i + 3]
                )
            ) {

                transitResultList.removeAt(i)
                transitResultList.removeAt(i)
                transitResultList.removeAt(i)
                transitResultList.removeAt(i)
                transitResultList.removeAt(i)
                i -= 5
                size -= 5


            } else {
                k += 5
            }
            i += 5

        }



        return transitResultList
    }





    internal fun check18(route: Int): Int {
        val routeResulting: Int
        when (route) {

            7 -> routeResulting = 124
            15 -> routeResulting = 116
            18 -> routeResulting = 118
            else -> routeResulting = route
        }
        return routeResulting
    }




}
